<script>
async function fetchInfo() {
  const uid = document.getElementById('uid').value.trim();
  const result = document.getElementById('result');

  if (!uid) {
    result.innerHTML = '<span class="error">Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ UID!</span>';
    return;
  }

  result.textContent = 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°... â³';

  const API_URL = "https://danger-info-alpha.vercel.app/accinfo";
  const API_KEY = "DANGERxINFO";

  try {
    const res = await fetch(`${API_URL}?uid=${uid}&key=${API_KEY}`);
    if (!res.ok) throw new Error("API Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½");

    const data = await res.json();
    if (!data.basicInfo) throw new Error("Ğ˜Ğ³Ñ€Ğ¾Ğº Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½");

    const b = data.basicInfo;
    const s = data.socialInfo || {};
    const c = data.clanBasicInfo || {};
    const p = data.petInfo || {};

    const text =
`â•”â•â• PLAYER PROFILE â•â•â•—

ğŸ‘¤ ĞĞ¸Ğº: ${b.nickname ?? 'â€”'}
ğŸ†” UID: ${b.accountId ?? uid}
ğŸŒ Ğ ĞµĞ³Ğ¸Ğ¾Ğ½: ${b.region ?? 'â€”'}
ğŸ– Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ: ${b.level ?? 'â€”'}
â¤ï¸ Ğ›Ğ°Ğ¹ĞºĞ¸: ${b.liked ?? 'â€”'}

ğŸ† BR Rank: ${b.rank ?? 'â€”'} (${b.rankingPoints ?? 'â€”'} pts)
ğŸ¯ CS Rank: ${b.csRank ?? 'â€”'} (${b.csRankingPoints ?? 'â€”'} pts)

ğŸ“… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½: ${formatTime(b.createAt)}
â° ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ²Ñ…Ğ¾Ğ´: ${formatTime(b.lastLoginAt)}

ğŸ¾ ĞŸĞ¸Ñ‚Ğ¾Ğ¼ĞµÑ†: ${p.name ?? 'ĞĞµÑ‚'} (Lv ${p.level ?? 'â€”'})

ğŸ° ĞšĞ»Ğ°Ğ½: ${c.clanName ?? 'ĞĞµÑ‚'}
ğŸ‘¥ Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²: ${c.memberNum ?? 'â€”'}/${c.capacity ?? 'â€”'}

ğŸŒ ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ: ${s.signature ?? 'ĞĞµÑ‚'}
`;

    result.textContent = text;

  } catch (e) {
    result.innerHTML = `<span class="error">ĞÑˆĞ¸Ğ±ĞºĞ°: ${e.message}</span>`;
  }
}

function formatTime(ts) {
  if (!ts) return "Unknown";
  const d = new Date(ts * 1000);
  return d.toLocaleString('ru-RU', {
    day: '2-digit',
    month: 'short',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  });
}
</script>
